(function(){var t,r,e,i,n,s={}.hasOwnProperty,o=[].slice;this.OverlappingMarkerSpiderfier=function(){function t(t,i){var n,o,u;for(n in this.map=t,null==i&&(i={}),null==this.constructor.N&&(this.constructor.N=!0,e=google.maps,r=e.event,a=e.MapTypeId,h.keepSpiderfied=!1,h.ignoreMapClick=!1,h.markersWontHide=!1,h.markersWontMove=!1,h.basicFormatEvents=!1,h.nearbyDistance=20,h.circleSpiralSwitchover=9,h.circleFootSeparation=23,h.circleStartAngle=l/12,h.spiralFootSeparation=26,h.spiralLengthStart=11,h.spiralLengthFactor=4,h.spiderfiedZIndex=e.Marker.MAX_ZINDEX+2e4,h.highlightedLegZIndex=e.Marker.MAX_ZINDEX+1e4,h.usualLegZIndex=e.Marker.MAX_ZINDEX+1,h.legWeight=1.5,h.legColors={usual:{},highlighted:{}},u=h.legColors.usual,o=h.legColors.highlighted,u[a.HYBRID]=u[a.SATELLITE]="#fff",o[a.HYBRID]=o[a.SATELLITE]="#f00",u[a.TERRAIN]=u[a.ROADMAP]="#444",o[a.TERRAIN]=o[a.ROADMAP]="#f00",this.constructor.j=function(t){return this.setMap(t)},this.constructor.j.prototype=new e.OverlayView,this.constructor.j.prototype.draw=function(){}),i)s.call(i,n)&&(o=i[n],this[n]=o);this.g=new this.constructor.j(this.map),this.C(),this.c={},this.B=this.l=null,this.addListener("click",(function(t,e){return r.trigger(t,"spider_click",e)})),this.addListener("format",(function(t,e){return r.trigger(t,"spider_format",e)})),this.ignoreMapClick||r.addListener(this.map,"click",function(t){return function(){return t.unspiderfy()}}(this)),r.addListener(this.map,"maptypeid_changed",function(t){return function(){return t.unspiderfy()}}(this)),r.addListener(this.map,"zoom_changed",function(t){return function(){if(t.unspiderfy(),!t.basicFormatEvents)return t.h()}}(this))}var r,e,i,n,a,h,u,l;for(i=0,n=(u=[t,h=t.prototype]).length;i<n;i++)u[i].VERSION="1.0.3";return l=2*Math.PI,e=r=a=null,t.markerStatus={SPIDERFIED:"SPIDERFIED",SPIDERFIABLE:"SPIDERFIABLE",UNSPIDERFIABLE:"UNSPIDERFIABLE",UNSPIDERFIED:"UNSPIDERFIED"},h.C=function(){this.a=[],this.s=[]},h.addMarker=function(t,r){return t.setMap(this.map),this.trackMarker(t,r)},h.trackMarker=function(t,e){var i;return null!=t._oms||(t._oms=!0,i=[r.addListener(t,"click",function(r){return function(e){return r.V(t,e)}}(this))],this.markersWontHide||i.push(r.addListener(t,"visible_changed",function(r){return function(){return r.D(t,!1)}}(this))),this.markersWontMove||i.push(r.addListener(t,"position_changed",function(r){return function(){return r.D(t,!0)}}(this))),null!=e&&i.push(r.addListener(t,"spider_click",e)),this.s.push(i),this.a.push(t),this.basicFormatEvents?this.trigger("format",t,this.constructor.markerStatus.UNSPIDERFIED):(this.trigger("format",t,this.constructor.markerStatus.UNSPIDERFIABLE),this.h())),this},h.D=function(t,r){if(!this.J&&!this.K)return null==t._omsData||!r&&t.getVisible()||this.unspiderfy(r?t:null),this.h()},h.getMarkers=function(){return this.a.slice(0)},h.removeMarker=function(t){return this.forgetMarker(t),t.setMap(null)},h.forgetMarker=function(t){var e,i,n,s,o;if(null!=t._omsData&&this.unspiderfy(),0>(e=this.A(this.a,t)))return this;for(i=0,n=(o=this.s.splice(e,1)[0]).length;i<n;i++)s=o[i],r.removeListener(s);return delete t._oms,this.a.splice(e,1),this.h(),this},h.removeAllMarkers=h.clearMarkers=function(){var t,r,e;for(e=this.getMarkers(),this.forgetAllMarkers(),t=0,r=e.length;t<r;t++)e[t].setMap(null);return this},h.forgetAllMarkers=function(){var t,e,i,n,s,o,a,h;for(this.unspiderfy(),t=e=0,i=(h=this.a).length;e<i;t=++e){for(o=h[t],a=0,t=(s=this.s[t]).length;a<t;a++)n=s[a],r.removeListener(n);delete o._oms}return this.C(),this},h.addListener=function(t,r){var e;return(null!=(e=this.c)[t]?e[t]:e[t]=[]).push(r),this},h.removeListener=function(t,r){var e;return 0>(e=this.A(this.c[t],r))||this.c[t].splice(e,1),this},h.clearListeners=function(t){return this.c[t]=[],this},h.trigger=function(){var t,r,e,i,n,s;for(r=arguments[0],t=2<=arguments.length?o.call(arguments,1):[],s=[],i=0,n=(r=null!=(e=this.c[r])?e:[]).length;i<n;i++)e=r[i],s.push(e.apply(null,t));return s},h.L=function(t,r){var i,n,s,o,a;for(o=this.circleFootSeparation*(2+t)/l,n=l/t,a=[],i=s=0;0<=t?s<t:s>t;i=0<=t?++s:--s)i=this.circleStartAngle+i*n,a.push(new e.Point(r.x+o*Math.cos(i),r.y+o*Math.sin(i)));return a},h.M=function(t,r){var i,n,s,o,a;for(o=this.spiralLengthStart,i=0,a=[],n=s=0;0<=t?s<t:s>t;n=0<=t?++s:--s)i+=this.spiralFootSeparation/o+5e-4*n,n=new e.Point(r.x+o*Math.cos(i),r.y+o*Math.sin(i)),o+=l*this.spiralLengthFactor/i,a.push(n);return a},h.V=function(t,r){var e,i,n,s,o,a,h,u,l;if((a=null!=t._omsData)&&this.keepSpiderfied||this.unspiderfy(),a||this.map.getStreetView().getVisible()||"GoogleEarthAPI"===this.map.getMapTypeId())return this.trigger("click",t,r);for(a=[],h=[],u=(e=this.nearbyDistance)*e,o=this.f(t.position),e=0,i=(l=this.a).length;e<i;e++)null!=(n=l[e]).map&&n.getVisible()&&(s=this.f(n.position),this.i(s,o)<u?a.push({R:n,G:s}):h.push(n));return 1===a.length?this.trigger("click",t,r):this.W(a,h)},h.markersNearMarker=function(t,r){var e,i,n,s,o,a,h,u,l,c;if(null==r&&(r=!1),null==this.g.getProjection())throw"Must wait for 'idle' event on map before calling markersNearMarker";for(h=(e=this.nearbyDistance)*e,o=this.f(t.position),a=[],e=0,i=(u=this.a).length;e<i&&!((n=u[e])!==t&&null!=n.map&&n.getVisible()&&(s=this.f(null!=(l=null!=(c=n._omsData)?c.v:void 0)?l:n.position),this.i(s,o)<h&&(a.push(n),r)));e++);return a},h.F=function(){var t,r,e,i,n,s,o,a,h,u,l,c;if(null==this.g.getProjection())throw"Must wait for 'idle' event on map before calling markersNearAnyOtherMarker";for(h=this.nearbyDistance,h*=h,c=[],u=0,r=(n=this.a).length;u<r;u++)i=n[u],c.push({H:this.f(null!=(t=null!=(e=i._omsData)?e.v:void 0)?t:i.position),b:!1});for(t=e=0,i=(u=this.a).length;e<i;t=++e)if(null!=(r=u[t]).getMap()&&r.getVisible()&&!(s=c[t]).b)for(r=a=0,n=(l=this.a).length;a<n;r=++a)if(o=l[r],r!==t&&null!=o.getMap()&&o.getVisible()&&(o=c[r],(!(r<t)||o.b)&&this.i(s.H,o.H)<h)){s.b=o.b=!0;break}return c},h.markersNearAnyOtherMarker=function(){var t,r,e,i,n,s,o;for(n=this.F(),o=[],t=r=0,e=(s=this.a).length;r<e;t=++r)i=s[t],n[t].b&&o.push(i);return o},h.setImmediate=function(t){return window.setTimeout(t,0)},h.h=function(){if(!this.basicFormatEvents&&null==this.l)return this.l=this.setImmediate((t=this,function(){return t.l=null,null!=t.g.getProjection()?t.w():null!=t.B?void 0:t.B=r.addListenerOnce(t.map,"idle",(function(){return t.w()}))}));var t},h.w=function(){var t,r,e,i,n,s,o;if(this.basicFormatEvents){for(n=[],r=0,e=markers.length;r<e;r++)t=null!=(i=markers[r])._omsData?"SPIDERFIED":"UNSPIDERFIED",n.push(this.trigger("format",i,this.constructor.markerStatus[t]));return n}for(n=this.F(),o=[],t=e=0,r=(s=this.a).length;e<r;t=++e)t=null!=(i=s[t])._omsData?"SPIDERFIED":n[t].b?"SPIDERFIABLE":"UNSPIDERFIABLE",o.push(this.trigger("format",i,this.constructor.markerStatus[t]));return o},h.P=function(t){return{m:(r=this,function(){return t._omsData.o.setOptions({strokeColor:r.legColors.highlighted[r.map.mapTypeId],zIndex:r.highlightedLegZIndex})}),u:function(r){return function(){return t._omsData.o.setOptions({strokeColor:r.legColors.usual[r.map.mapTypeId],zIndex:r.usualLegZIndex})}}(this)};var r},h.W=function(t,i){var n,s,o,a,h,u,l,c,f,g;return this.J=!0,g=t.length,n=this.T(function(){var r,e,i;for(i=[],r=0,e=t.length;r<e;r++)c=t[r],i.push(c.G);return i}()),a=g>=this.circleSpiralSwitchover?this.M(g,n).reverse():this.L(g,n),n=function(){var i,n,c;for(c=[],i=0,n=a.length;i<n;i++)o=a[i],s=this.U(o),f=this.S(t,function(t){return function(r){return t.i(r.G,o)}}(this)),l=f.R,u=new e.Polyline({map:this.map,path:[l.position,s],strokeColor:this.legColors.usual[this.map.mapTypeId],strokeWeight:this.legWeight,zIndex:this.usualLegZIndex}),l._omsData={v:l.getPosition(),X:l.getZIndex(),o:u},this.legColors.highlighted[this.map.mapTypeId]!==this.legColors.usual[this.map.mapTypeId]&&(h=this.P(l),l._omsData.O={m:r.addListener(l,"mouseover",h.m),u:r.addListener(l,"mouseout",h.u)}),this.trigger("format",l,this.constructor.markerStatus.SPIDERFIED),l.setPosition(s),l.setZIndex(Math.round(this.spiderfiedZIndex+o.y)),c.push(l);return c}.call(this),delete this.J,this.I=!0,this.trigger("spiderfy",n,i)},h.unspiderfy=function(t){var e,i,n,s,o,a,h;if(null==t&&(t=null),null==this.I)return this;for(this.K=!0,h=[],o=[],e=0,i=(a=this.a).length;e<i;e++)null!=(s=a[e])._omsData?(s._omsData.o.setMap(null),s!==t&&s.setPosition(s._omsData.v),s.setZIndex(s._omsData.X),null!=(n=s._omsData.O)&&(r.removeListener(n.m),r.removeListener(n.u)),delete s._omsData,s!==t&&(n=this.basicFormatEvents?"UNSPIDERFIED":"SPIDERFIABLE",this.trigger("format",s,this.constructor.markerStatus[n])),h.push(s)):o.push(s);return delete this.K,delete this.I,this.trigger("unspiderfy",h,o),this},h.i=function(t,r){var e,i;return(e=t.x-r.x)*e+(i=t.y-r.y)*i},h.T=function(t){var r,i,n,s,o;for(r=s=o=0,i=t.length;r<i;r++)s+=(n=t[r]).x,o+=n.y;return t=t.length,new e.Point(s/t,o/t)},h.f=function(t){return this.g.getProjection().fromLatLngToDivPixel(t)},h.U=function(t){return this.g.getProjection().fromDivPixelToLatLng(t)},h.S=function(t,r){var e,i,n,s,o,a;for(n=o=0,a=t.length;o<a;n=++o)s=r(s=t[n]),(null==e||s<i)&&(i=s,e=n);return t.splice(e,1)[0]},h.A=function(t,r){var e,i,n;if(null!=t.indexOf)return t.indexOf(r);for(e=i=0,n=t.length;i<n;e=++i)if(t[e]===r)return e;return-1},t}(),r=/(\?.*(&|&amp;)|\?)spiderfier_callback=(\w+)/,null==(t=document.currentScript)&&(t=function(){var t,e,i,s,o;for(o=[],t=0,e=(i=document.getElementsByTagName("script")).length;t<e;t++)null!=(s=(n=i[t]).getAttribute("src"))&&s.match(r)&&o.push(n);return o}()[0]),null!=t&&(t=null!=(e=t.getAttribute("src"))&&null!=(i=e.match(r))?i[3]:void 0)&&"function"==typeof window[t]&&window[t](),"function"==typeof window.spiderfier_callback&&window.spiderfier_callback()}).call(this);